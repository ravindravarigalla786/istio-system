profile: ambient

# Replica configuration
replicaCount: 2

# Autoscaling configuration
autoscaleEnabled: true
autoscaleMin: 2
autoscaleMax: 5

# Resource configuration
resources:
  requests:
    cpu: 1
    memory: 4Gi

# Global settings apply to all istiod components
global:
  # Production-ready image configuration
  hub: docker.io/istio
  tag: 1.28.3
  imagePullPolicy: IfNotPresent
  defaultNodeSelector:
    karpenter.sh/nodepool: system
  defaultTolerations:
  - key: CriticalAddonsOnly
    operator: Exists
    effect: NoSchedule

pilot:
  env:
    PILOT_ENABLE_AMBIENT: "true"
  nodeSelector:
    karpenter.sh/nodepool: system
  tolerations:
  - key: CriticalAddonsOnly
    operator: Exists
    effect: NoSchedule

# Explicitly set meshConfig to enable ambient
meshConfig:
  defaultConfig:
    proxyMetadata:
      ISTIO_META_ENABLE_HBONE: "true"
